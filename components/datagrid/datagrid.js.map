{"version":3,"file":"datagrid.js","sourceRoot":"","sources":["datagrid.ts"],"names":[],"mappings":"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","sourcesContent":["import {NgModule,Component,ElementRef,AfterViewInit,AfterContentInit,OnDestroy,Input,Output,SimpleChange,EventEmitter,ContentChild,ContentChildren,QueryList,TemplateRef} from '@angular/core';\r\nimport {CommonModule} from '@angular/common';\r\nimport {Header,Footer,PrimeTemplate,SharedModule} from '../common/shared';\r\nimport {PaginatorModule} from '../paginator/paginator';\r\nimport {BlockableUI} from '../common/api';\r\n\r\n@Component({\r\n    selector: 'p-dataGrid',\r\n    template: `\r\n        <div [ngClass]=\"'ui-datagrid ui-widget'\" [ngStyle]=\"style\" [class]=\"styleClass\">\r\n            <div class=\"ui-datagrid-header ui-widget-header ui-corner-top\" *ngIf=\"header\">\r\n                <ng-content select=\"p-header\"></ng-content>\r\n            </div>\r\n            <p-paginator [rows]=\"rows\" [first]=\"first\" [totalRecords]=\"totalRecords\" [pageLinkSize]=\"pageLinks\" \r\n                (onPageChange)=\"paginate($event)\" styleClass=\"ui-paginator-bottom\" [rowsPerPageOptions]=\"rowsPerPageOptions\" *ngIf=\"paginator && paginatorPosition!='bottom' || paginatorPosition =='both'\"></p-paginator>\r\n            <div class=\"ui-datagrid-content ui-widget-content\">\r\n                <div class=\"ui-g\">\r\n                    <ng-template ngFor [ngForOf]=\"dataToRender\" [ngForTemplate]=\"itemTemplate\"></ng-template>\r\n                    <div *ngIf=\"isEmpty()\" class=\"ui-widget-content ui-g-12\">{{emptyMessage}}</div>\r\n                </div>\r\n            </div>\r\n            <p-paginator [rows]=\"rows\" [first]=\"first\" [totalRecords]=\"totalRecords\" [pageLinkSize]=\"pageLinks\" \r\n                (onPageChange)=\"paginate($event)\" styleClass=\"ui-paginator-bottom\" [rowsPerPageOptions]=\"rowsPerPageOptions\" *ngIf=\"paginator && paginatorPosition!='top' || paginatorPosition =='both'\"></p-paginator>\r\n            <div class=\"ui-datagrid-footer ui-widget-header ui-corner-top\" *ngIf=\"footer\">\r\n                <ng-content select=\"p-footer\"></ng-content>\r\n            </div>\r\n        </div>\r\n    `\r\n})\r\nexport class DataGrid implements AfterViewInit,AfterContentInit,BlockableUI {\r\n\r\n    @Input() paginator: boolean;\r\n\r\n    @Input() rows: number;\r\n    \r\n    @Input() totalRecords: number;\r\n\r\n    @Input() pageLinks: number = 5;\r\n    \r\n    @Input() rowsPerPageOptions: number[];\r\n\r\n    @Input() lazy: boolean;\r\n\r\n    @Input() emptyMessage: string = 'No records found';\r\n    \r\n    @Output() onLazyLoad: EventEmitter<any> = new EventEmitter();\r\n\r\n    @Input() style: any;\r\n\r\n    @Input() styleClass: string;\r\n    \r\n    @Input() paginatorPosition: string = 'bottom';\r\n    \r\n    @Output() onPage: EventEmitter<any> = new EventEmitter();\r\n            \r\n    @ContentChild(Header) header;\r\n\r\n    @ContentChild(Footer) footer;\r\n    \r\n    @ContentChildren(PrimeTemplate) templates: QueryList<any>;\r\n    \r\n    public _value: any[];\r\n    \r\n    public itemTemplate: TemplateRef<any>;\r\n\r\n    public dataToRender: any[];\r\n\r\n    public first: number = 0;\r\n    \r\n    public page: number = 0;\r\n    \r\n    constructor(public el: ElementRef) {}\r\n\r\n    ngAfterViewInit() {\r\n        if(this.lazy) {\r\n            this.onLazyLoad.emit({\r\n                first: this.first,\r\n                rows: this.rows\r\n            });\r\n        }\r\n    }\r\n    \r\n    ngAfterContentInit() {\r\n        this.templates.forEach((item) => {\r\n            switch(item.getType()) {\r\n                case 'item':\r\n                    this.itemTemplate = item.template;\r\n                break;\r\n                \r\n                default:\r\n                    this.itemTemplate = item.template;\r\n                break;\r\n            }\r\n        });\r\n    }\r\n    \r\n    @Input() get value(): any[] {\r\n        return this._value;\r\n    }\r\n\r\n    set value(val:any[]) {\r\n        this._value = val;\r\n        this.handleDataChange();\r\n    }\r\n    \r\n    handleDataChange() {\r\n        if(this.paginator) {\r\n            this.updatePaginator();\r\n        }\r\n        this.updateDataToRender(this.value);\r\n    }\r\n    \r\n    updatePaginator() {\r\n        //total records\r\n        this.totalRecords = this.lazy ? this.totalRecords : (this.value ? this.value.length: 0);\r\n        \r\n        //first\r\n        if(this.totalRecords && this.first >= this.totalRecords) {\r\n            let numberOfPages = Math.ceil(this.totalRecords/this.rows);\r\n            this.first = Math.max((numberOfPages-1) * this.rows, 0);\r\n        }\r\n    }\r\n\r\n    paginate(event) {\r\n        this.first = event.first;\r\n        this.rows = event.rows;\r\n        \r\n        if(this.lazy) {\r\n            this.onLazyLoad.emit(this.createLazyLoadMetadata());\r\n        }\r\n        else {\r\n            this.updateDataToRender(this.value);\r\n        }\r\n        \r\n        this.onPage.emit({\r\n            first: this.first,\r\n            rows: this.rows\r\n        });\r\n    }\r\n\r\n    updateDataToRender(datasource) {\r\n        if(this.paginator && datasource) {\r\n            this.dataToRender = [];\r\n            let startIndex = this.lazy ? 0 : this.first;\r\n            for(let i = startIndex; i < (startIndex+ this.rows); i++) {\r\n                if(i >= datasource.length) {\r\n                    break;\r\n                }\r\n\r\n                this.dataToRender.push(datasource[i]);\r\n            }\r\n        }\r\n        else {\r\n            this.dataToRender = datasource;\r\n        }\r\n    }\r\n\r\n    isEmpty() {\r\n        return !this.dataToRender||(this.dataToRender.length == 0);\r\n    }\r\n    \r\n    createLazyLoadMetadata(): any {\r\n        return {\r\n            first: this.first,\r\n            rows: this.rows\r\n        };\r\n    }\r\n    \r\n    getBlockableElement(): HTMLElementÂ {\r\n        return this.el.nativeElement.children[0];\r\n    }\r\n}\r\n\r\n@NgModule({\r\n    imports: [CommonModule,SharedModule,PaginatorModule],\r\n    exports: [DataGrid,SharedModule],\r\n    declarations: [DataGrid]\r\n})\r\nexport class DataGridModule { }\r\n"]}